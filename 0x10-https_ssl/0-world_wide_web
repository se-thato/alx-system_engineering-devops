#!/usr/bin/env bash
# shellcheck disable=SC2086

domain="$1"
subdomain="$2"

get_record_info() {
    local sub="$1"
    local dom="$2"
    local full="${sub}.${dom}"
    dig "$full" | awk -v sub="$sub" '
        $1 == ";;" && $2 == "ANSWER" && $3 == "SECTION:" {getline; print "The subdomain " sub " is a " $4 " record and points to " $5; found=1}
        END {if (!found) print "The subdomain " sub " is a record and points to "}
    '
}

if [[ -z "$domain" ]]; then
    echo "Usage: $0 <domain> [subdomain]"
    exit 1
fi

if [[ -z "$subdomain" ]]; then
    for name in www lb-01 web-01 web-02; do
        get_record_info "$name" "$domain"
    done
else
    get_record_info "$subdomain" "$domain"
fi